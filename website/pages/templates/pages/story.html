{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Word cloud of popular topics | Foggymedia</title>
    <meta name="description" content="A captivating word cloud featuring the latest topics in Indian news. Explore the trending discussions from {{channel.name}} and see what the media is buzzing about!">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="bg-gray-800 text-white h-screen">
    <div id="main-content">
        <div class="pt-4 w-auto flex items-center position-fixed">
            <!-- Close button icon -->
            <button class="mr-2 p-2" onclick="goBack()">
                <i class="fa-solid fa-arrow-left fa-xl" style="color: #ffffff;"></i>
            </button>

            <!-- Channel logo -->
            <div class="w-8 h-8 rounded-full overflow-hidden bg-gray-300">
                <img id="channel-logo" src="{{ channel.logo.url }}" alt="{{ channel.name }} Logo"
                    class="max-w-full max-h-full object-cover rounded-full">
            </div>

            <!-- Channel name -->
            <h1 class="text-lg px-2">
                <a id="channel-name" href="{% url 'channel_name' channel.slug %}" class="text-white">{{ channel.name }}</a>
                <i class="fas fa-chevron-down ml-1 text-white fa-xs"></i>
            </h1>
        </div>
        <div
            class="bg-gray-800 mt-16 mx-3 rounded border border-gray-600 p-2 text-xs text-white">
            <i class="fa-regular fa-circle-info" style="color: #ffffff;"></i>
            Word cloud generated by YouTube news video titles of the last 48 hours.
        </div>

        <!-- Story image/video -->
        <div class="container flex items-center mx-auto justify-center mt-20 lg:h-4/5 lg:mt-0">

            <div class="w-full custom-container h-2/3">
                {% with channel_name_encoded=channel.name|urlencode %}
                <img id="story-image" src="{% static 'function/clouds/' %}{{ channel_name_encoded }}.svg"
                    class="w-full h-full lg:w-1/2 lg:h-1/2 object-contain rounded-lg flex justify-center mx-auto" alt="Story image/video">
                {% endwith %}
            </div>

        </div>
    

        <div class="swiper-container fixed bottom-0 left-0 w-full pb-5 lg:mx-auto lg:flex lg:justify-center">
            <div class="swiper-wrapper flex overflow-x-auto scrollbar-hide">
                {% for channel in channels %}
                <div class="swiper-slide w-20 flex-shrink-0">
                    <div class="h-14 w-14 rounded-full overflow-hidden bg-gray-300 flex items-center justify-center">
                        <img src="{{ channel.logo.url }}" alt="{{ channel.name }} Logo"
                            class="max-w-full max-h-full object-cover rounded-full"
                            onclick="updateChannelStory('{{ channel.name|urlencode }}', '{{ channel.logo.url|urlencode }}', '{% static 'function/clouds/' %}{{ channel.name}}.svg', '{% url 'channel_name' channel.slug %}')">
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

        <script>
            function goBack() {
                history.go(-1);
            }
        
            function updateChannelStory(newChannelName, newLogoURL, newStoryImage, newChannelURL) {
                const decodedChannelName = decodeURIComponent(newChannelName);
                const channelNameLink = document.getElementById('channel-name');
                channelNameLink.textContent = decodedChannelName;
                channelNameLink.href = newChannelURL;
                document.getElementById('channel-logo').src = newLogoURL;
                document.getElementById('story-image').src = newStoryImage;
        
                // Update URL in the browser
                const newURL = window.location.origin + newChannelURL;
                history.pushState(null, '', newURL);
        
                // Add touch events for story navigation
                var touchStartX = 0;
                var touchEndX = 0;
        
                var storyContainer = document.querySelector('.custom-container');
                var hammertime = new Hammer(storyContainer);
        
                hammertime.on('swiperight', function () {
                    navigateToPreviousStory();
                });
        
                hammertime.on('swipeleft', function () {
                    navigateToNextStory();
                });
        
                function navigateToPreviousStory() {
                    // Logic to navigate to the previous story
                    console.log('Navigating to previous story');
                }
        
                function navigateToNextStory() {
                    // Logic to navigate to the next story
                    console.log('Navigating to next story');
                }
            }
        </script>
    </div>
</body>

</html>
